# 系統功能待辦清單 (Feature Backlog)

> 📋 本文檔追蹤使用者手冊中描述的功能與實際系統實作之間的差異，以及待開發的功能清單。

**最後更新：** 2025-10-21

---

## 📊 優先級定義

- **🔴 P0 - 緊急且重要**：核心功能缺失，嚴重影響使用體驗
- **🟠 P1 - 重要但不緊急**：重要功能缺失，影響使用便利性
- **🟡 P2 - 中等優先級**：一般功能缺失或體驗優化
- **🟢 P3 - 低優先級**：Nice to have 功能

---

# 第一章：KOL 管理

## 🔴 P0 - 緊急且重要

### 1. 頁面上方統計區塊缺失
**文檔描述（1.3 章節）：**
```
頁面上方統計區：
- KOL 總數：目前系統中有多少個 KOL
- 啟用中：目前可以使用的 KOL 數量
- 本週發文數：所有 KOL 本週的總發文量
```

**現狀：**
- ❌ 頁面 https://forum-autoposter-dz27.vercel.app/content-management/kols 完全缺失統計區塊
- ❌ 無法快速了解系統 KOL 總體情況

**需要實作：**
1. 在頁面頂部（標題下方）新增統計卡片區塊
2. 顯示以下統計數據：
   - **KOL 總數**：從 `/api/kol/list` 計算總數
   - **啟用中**：計算 `status === 'active'` 的 KOL 數量
   - **本週發文數**：需要新增 API 端點計算本週發文總數
3. 統計卡片應該在「刷新」時同步更新

**預估工作量：** 4-6 小時
- 前端 UI 設計：2 小時
- 後端 API（本週發文數統計）：2-3 小時
- 整合測試：1 小時

**參考設計：**
```tsx
<Row gutter={16} style={{ marginBottom: 24 }}>
  <Col span={8}>
    <Card>
      <Statistic title="KOL 總數" value={totalKOLs} prefix={<UserOutlined />} />
    </Card>
  </Col>
  <Col span={8}>
    <Card>
      <Statistic title="啟用中" value={activeKOLs} prefix={<CheckCircleOutlined />} />
    </Card>
  </Col>
  <Col span={8}>
    <Card>
      <Statistic title="本週發文數" value={weeklyPosts} prefix={<FileTextOutlined />} />
    </Card>
  </Col>
</Row>
```

---

### 2. 表格欄位數據為空（總貼文數、已發布、互動率）
**問題描述：**
- 在 KOL 列表表格中，以下欄位顯示為空白或無意義的值：
  - **總貼文數** (total_posts)
  - **已發布** (published_posts)
  - **互動率** (avg_interaction_rate)

**現狀：**
- API `/api/kol/list` 返回的數據中這些欄位可能為 null 或 0
- 沒有從實際發文記錄（post_records）中計算這些統計數據

**需要實作：**
1. **後端修改**：
   - 在 `/api/kol/list` API 中，針對每個 KOL 計算真實數據：
     - `total_posts`：從 `post_records` 表中統計該 KOL 的總發文數
     - `published_posts`：統計 `status = 'published'` 的發文數
     - `avg_interaction_rate`：計算平均互動率（如果有互動數據）
2. **前端配合**：
   - 點擊「刷新」按鈕時，重新 fetch 這些數據
   - 顯示載入狀態（Spin/Skeleton）

**預估工作量：** 6-8 小時
- 後端 API 修改（統計邏輯）：4-5 小時
- 前端顯示優化：1-2 小時
- 測試與驗證：1-2 小時

**SQL 查詢參考：**
```sql
-- 計算每個 KOL 的發文數
SELECT
  kol_serial,
  COUNT(*) as total_posts,
  COUNT(CASE WHEN status = 'published' THEN 1 END) as published_posts
FROM post_records
GROUP BY kol_serial;

-- 計算平均互動率（如果有互動數據）
SELECT
  kol_serial,
  AVG(interaction_rate) as avg_interaction_rate
FROM post_records
WHERE interaction_rate IS NOT NULL
GROUP BY kol_serial;
```

---

## 🟠 P1 - 重要但不緊急

### 3. KOL 詳細資料頁面/按鈕缺失
**文檔描述（1.6 章節）：**
```
操作步驟：
1. 點擊 KOL 列表中的「👁️ 查看」按鈕
2. 畫面會顯示此 KOL 的完整資訊

KOL 詳情頁面內容：
- 上方統計卡片：總發文數、本週發文、平均互動率、最佳表現文章
- 中間區塊：KOL 設定檔（完整顯示所有設定）
- 下方區塊：近期發文歷史（最近 20 篇文章表格）
```

**現狀：**
- ❌ 表格中沒有「👁️ 查看」按鈕
- ❌ 只有「編輯」和「刪除」按鈕
- ❌ 無法查看 KOL 的詳細統計和近期發文歷史

**需要實作：**
1. **新增「查看」按鈕**：
   - 在表格「操作」欄位新增「👁️ 查看」按鈕
2. **創建 KOL 詳細頁面/Modal**：
   - 可以是新的頁面路由（如 `/content-management/kols/:serial`）
   - 或是一個大型 Modal
3. **頁面內容**：
   - **上方統計卡片區**（4 個卡片）：
     - 總發文數
     - 本週發文數
     - 平均互動率
     - 最佳表現文章（點擊可查看）
   - **中間區塊**：KOL 完整設定（唯讀模式）
   - **下方區塊**：近期發文歷史表格
     - 顯示最近 20 篇文章
     - 欄位：發布時間、標題、股票代號、互動數據（讚/留言/分享）、互動率
4. **新增 API 端點**：
   - `/api/kol/:serial/recent-posts` - 獲取近期發文
   - `/api/kol/:serial/best-post` - 獲取最佳表現文章

**預估工作量：** 10-14 小時
- 前端 UI 設計與實作：6-8 小時
- 後端 API 開發：3-4 小時
- 整合測試：1-2 小時

**建議實作方式：**
- 使用 Modal（較快）或獨立頁面（較完整）
- 建議使用 **Ant Design Drawer** 側邊欄，可以更好地展示詳細資訊

---

### 4. 狀態切換開關缺失
**文檔描述（1.7 章節）：**
```
操作步驟：
1. 在 KOL 列表中，找到該 KOL
2. 點擊「狀態」欄位的開關
   - 🟢 啟用 → 🔴 停用
   - 🔴 停用 → 🟢 啟用
```

**現狀：**
- ❌ 「狀態」欄位只是顯示 Tag（綠色/紅色），無法點擊
- ❌ 需要進入編輯頁面才能修改狀態

**需要實作：**
1. 將「狀態」欄位改為 `<Switch>` 組件
2. 點擊時調用 API 更新狀態
3. 顯示載入狀態和成功/失敗訊息

**預估工作量：** 2-3 小時
- 前端 UI 修改：1 小時
- 後端 API（如果缺失）：1 小時
- 測試：30 分鐘

**代碼參考：**
```tsx
{
  title: '狀態',
  dataIndex: 'status',
  key: 'status',
  render: (status: string, record: KOLProfile) => (
    <Switch
      checked={status === 'active'}
      checkedChildren="啟用"
      unCheckedChildren="停用"
      onChange={(checked) => handleStatusChange(record.serial, checked)}
    />
  ),
}
```

---

## 🟡 P2 - 中等優先級

### 5. 創建 KOL 流程與文檔不符
**文檔描述（1.4 章節）：**
創建 KOL 應包含 6 大部分詳細設定：
1. 帳號資訊
2. 角色定位
3. 寫作風格
4. 語氣強度設定（5 個滑桿）
5. 內容結構偏好
6. 進階設定

**現狀：**
- 創建流程較為簡化，只有基本欄位 + AI 描述 + Prompt 設定
- 沒有詳細的語氣滑桿、內容結構等設定

**決策點：**
- **選項 A**：保持簡化流程，更新文檔以匹配實際實作（推薦）
- **選項 B**：擴展創建流程，實作完整的 6 部分設定（工作量大）

**如果選擇選項 A（更新文檔）：**
- 工作量：2-3 小時
- 只需更新 Chapter 1 文檔，移除過於詳細的創建流程描述

**如果選擇選項 B（實作完整流程）：**
- 工作量：16-20 小時
- 需要重新設計創建 Modal，新增多個步驟或標籤頁

**建議：** 選擇選項 A，因為當前有 AI 自動生成功能，創建後可以在編輯頁面精細調整。

---

## 🟢 P3 - 低優先級（Nice to Have）

### 6. 搜尋與篩選功能
**建議新增：**
- 按暱稱搜尋 KOL
- 按人設篩選（技術分析、基本面分析等）
- 按狀態篩選（啟用/停用）

**預估工作量：** 4-6 小時

---

### 7. 排序功能
**建議新增：**
- 按總發文數排序
- 按互動率排序
- 按創建時間排序

**預估工作量：** 2-3 小時

---

### 8. 批量操作功能
**建議新增：**
- 批量啟用/停用 KOL
- 批量刪除 KOL
- 批量匯出 KOL 設定

**預估工作量：** 8-10 小時

---

# 第二章：發文生成設定

> 🚧 待補充（目前專注於第一章）

---

# 第三章：批次歷史與審核

> 🚧 待補充

---

# 第四章：排程管理

> 🚧 待補充

---

# 第五章：互動分析

> 🚧 待補充

---

# 第六章：自我學習與優化

> 🚧 待補充

---

## 📅 開發排程建議

### Sprint 1（本週 1-2 天）
**目標：修復核心數據顯示問題**
- [ ] P0-2: 修復表格欄位數據為空的問題
- [ ] P0-1: 新增頁面上方統計區塊

### Sprint 2（下週 2-3 天）
**目標：完善 KOL 查看功能**
- [ ] P1-3: 實作 KOL 詳細資料頁面
- [ ] P1-4: 新增狀態切換開關

### Sprint 3（未來規劃）
**目標：優化使用體驗**
- [ ] P2-5: 決定創建流程策略並更新文檔
- [ ] P3-6/7/8: 搜尋、排序、批量操作功能

---

## 📝 更新記錄

- **2025-10-21**：初始版本，記錄第一章 KOL 管理的功能缺口
  - 識別 P0 級別問題：統計區塊缺失、數據為空
  - 識別 P1 級別問題：詳細頁面缺失、狀態切換缺失
  - 規劃開發排程建議
