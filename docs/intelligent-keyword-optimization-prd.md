# æ™ºèƒ½å„ªåŒ–é—œéµå­—ç³»çµ± PRD

## ğŸ“‹ ç”¢å“éœ€æ±‚æ–‡æª” (PRD)

### ğŸ¯ ç”¢å“æ¦‚è¿°

**ç”¢å“åç¨±**: æ™ºèƒ½å„ªåŒ–é—œéµå­—ç³»çµ± (Intelligent Keyword Optimization System)  
**ç‰ˆæœ¬**: v1.0  
**å‰µå»ºæ—¥æœŸ**: 2025-01-15  
**è² è²¬äºº**: AI Assistant  

### ğŸ” èƒŒæ™¯èˆ‡å•é¡Œ

#### ç¾æœ‰å•é¡Œ
1. **Prompt é‡è¤‡ä½¿ç”¨**: ç†±é–€è©±é¡Œå’Œæ¼²åœåˆ†æä½¿ç”¨ç›¸åŒçš„ prompt æ¨¡æ¿
2. **ç¼ºä¹é‡å°æ€§**: æ²’æœ‰æ ¹æ“šä¸åŒè§¸ç™¼å™¨é¡å‹èª¿æ•´å…§å®¹é¢¨æ ¼
3. **é—œéµå­—ç­–ç•¥å–®ä¸€**: æ‰€æœ‰è§¸ç™¼å™¨éƒ½ä½¿ç”¨å›ºå®šçš„é—œéµå­—æœå°‹ç­–ç•¥
4. **Serper API æ•´åˆåˆ†æ•£**: å¤šå€‹é‡è¤‡å¯¦ç¾ï¼Œç¼ºä¹çµ±ä¸€ç®¡ç†

#### æ¥­å‹™å½±éŸ¿
- å…§å®¹é‡è¤‡æ€§é«˜ï¼Œå½±éŸ¿ KOL å€‹æ€§åŒ–è¡¨ç¾
- æœå°‹çµæœç›¸é—œæ€§ä½ï¼Œå½±éŸ¿å…§å®¹å“è³ª
- ç¶­è­·æˆæœ¬é«˜ï¼Œä»£ç¢¼é‡è¤‡

### ğŸ¯ ç”¢å“ç›®æ¨™

#### ä¸»è¦ç›®æ¨™
1. **å¯¦ç¾è§¸ç™¼å™¨å°ˆç”¨ Prompt**: ä¸åŒè§¸ç™¼å™¨ä½¿ç”¨å°ˆå±¬çš„ title å’Œ content agent prompt
2. **æ™ºèƒ½é—œéµå­—ç”Ÿæˆ**: ä½¿ç”¨ LLM å‹•æ…‹ç”Ÿæˆæœ€å„ªæœå°‹é—œéµå­—
3. **çµ±ä¸€ Serper API æ•´åˆ**: å»ºç«‹çµ±ä¸€çš„é—œéµå­—å„ªåŒ–å’Œæ–°èæœå°‹ç³»çµ±

#### æˆåŠŸæŒ‡æ¨™
- å…§å®¹é‡è¤‡ç‡é™ä½ 60%
- æœå°‹çµæœç›¸é—œæ€§æå‡ 40%
- ä»£ç¢¼é‡è¤‡ç‡é™ä½ 80%

### ğŸ—ï¸ ç³»çµ±æ¶æ§‹è¨­è¨ˆ

#### æ ¸å¿ƒçµ„ä»¶

##### 1. è§¸ç™¼å™¨å°ˆç”¨ Prompt ç³»çµ±
```
TriggerSpecificPromptSystem
â”œâ”€â”€ TrendingTopicPromptStrategy
â”œâ”€â”€ LimitUpAfterHoursPromptStrategy  
â”œâ”€â”€ IntradayLimitUpPromptStrategy
â”œâ”€â”€ CustomStocksPromptStrategy
â”œâ”€â”€ NewsEventPromptStrategy
â””â”€â”€ EarningsReportPromptStrategy
```

##### 2. æ™ºèƒ½é—œéµå­—å„ªåŒ–ç³»çµ±
```
IntelligentKeywordOptimizer
â”œâ”€â”€ KeywordGenerationAgent
â”œâ”€â”€ SearchStrategySelector
â”œâ”€â”€ RelevanceAnalyzer
â””â”€â”€ KeywordRefinementEngine
```

##### 3. çµ±ä¸€ Serper API æ•´åˆ
```
UnifiedSerperIntegration
â”œâ”€â”€ SerperClient
â”œâ”€â”€ NewsSearchEngine
â”œâ”€â”€ KeywordOptimizer
â””â”€â”€ ContentEnhancer
```

### ğŸ“ åŠŸèƒ½éœ€æ±‚

#### åŠŸèƒ½ 1: è§¸ç™¼å™¨å°ˆç”¨ Prompt ç³»çµ±

##### 1.1 ç†±é–€è©±é¡Œ Prompt ç­–ç•¥
**ç›®æ¨™**: ç‚ºç†±é–€è©±é¡Œè§¸ç™¼å™¨è¨­è¨ˆå°ˆç”¨çš„ prompt æ¨¡æ¿

**åŠŸèƒ½æè¿°**:
- å°ˆæ³¨æ–¼è©±é¡Œè¨è«–å’Œç¤¾ç¾¤äº’å‹•
- å¼·èª¿è©±é¡Œçš„ç¤¾æœƒå½±éŸ¿åŠ›å’Œè¨è«–ç†±åº¦
- ä½¿ç”¨æ›´è¼•é¬†ã€äº’å‹•æ€§å¼·çš„èªæ°£
- åŒ…å«è©±é¡ŒèƒŒæ™¯å’Œç›¸é—œæ–°è

**Prompt ç‰¹é»**:
```
ç³»çµ±è§’è‰²: ä½ æ˜¯ {kol_nickname}ï¼Œä¸€å€‹å–„æ–¼æ•æ‰å¸‚å ´ç†±é»çš„ {kol_persona} åˆ†æå¸«
å…§å®¹é‡é»: 
- è©±é¡Œçš„ç¤¾æœƒå½±éŸ¿åŠ›
- ç›¸é—œæ–°èå’ŒèƒŒæ™¯
- æŠ•è³‡æ©Ÿæœƒåˆ†æ
- é¢¨éšªæé†’
èªæ°£é¢¨æ ¼: è¼•é¬†äº’å‹•ï¼Œå–„æ–¼å¼•ç™¼è¨è«–
```

##### 1.2 ç›¤å¾Œæ¼²åœ Prompt ç­–ç•¥
**ç›®æ¨™**: ç‚ºç›¤å¾Œæ¼²åœè§¸ç™¼å™¨è¨­è¨ˆå°ˆç”¨çš„ prompt æ¨¡æ¿

**åŠŸèƒ½æè¿°**:
- å°ˆæ³¨æ–¼æŠ€è¡“åˆ†æå’Œç±Œç¢¼é¢
- å¼·èª¿æ¼²åœåŸå› å’Œå¾ŒçºŒèµ°å‹¢é æ¸¬
- ä½¿ç”¨å°ˆæ¥­ã€ç†æ€§çš„åˆ†æèªæ°£
- åŒ…å«æŠ€è¡“æŒ‡æ¨™å’Œç±Œç¢¼åˆ†æ

**Prompt ç‰¹é»**:
```
ç³»çµ±è§’è‰²: ä½ æ˜¯ {kol_nickname}ï¼Œä¸€å€‹å°ˆæ¥­çš„ {kol_persona} æŠ€è¡“åˆ†æå¸«
å…§å®¹é‡é»:
- æ¼²åœåŸå› åˆ†æ
- æŠ€è¡“æŒ‡æ¨™è§£è®€
- ç±Œç¢¼é¢åˆ†æ
- å¾ŒçºŒèµ°å‹¢é æ¸¬
èªæ°£é¢¨æ ¼: å°ˆæ¥­ç†æ€§ï¼Œæ•¸æ“šå°å‘
```

##### 1.3 ç›¤ä¸­æ¼²åœ Prompt ç­–ç•¥
**ç›®æ¨™**: ç‚ºç›¤ä¸­æ¼²åœè§¸ç™¼å™¨è¨­è¨ˆå°ˆç”¨çš„ prompt æ¨¡æ¿

**åŠŸèƒ½æè¿°**:
- å°ˆæ³¨æ–¼å³æ™‚å¸‚å ´å‹•æ…‹å’Œäº¤æ˜“æ©Ÿæœƒ
- å¼·èª¿çŸ­ç·šæ“ä½œå’Œé¢¨éšªæ§åˆ¶
- ä½¿ç”¨ç·Šæ¹Šã€è¡Œå‹•å°å‘çš„èªæ°£
- åŒ…å«å³æ™‚æ•¸æ“šå’Œäº¤æ˜“å»ºè­°

**Prompt ç‰¹é»**:
```
ç³»çµ±è§’è‰²: ä½ æ˜¯ {kol_nickname}ï¼Œä¸€å€‹æ•éŠ³çš„ {kol_persona} çŸ­ç·šäº¤æ˜“å“¡
å…§å®¹é‡é»:
- å³æ™‚å¸‚å ´å‹•æ…‹
- çŸ­ç·šäº¤æ˜“æ©Ÿæœƒ
- é¢¨éšªæ§åˆ¶æé†’
- æ“ä½œå»ºè­°
èªæ°£é¢¨æ ¼: ç·Šæ¹Šè¡Œå‹•ï¼Œå³æ™‚åæ‡‰
```

#### åŠŸèƒ½ 2: æ™ºèƒ½é—œéµå­—ç”Ÿæˆç³»çµ±

##### 2.1 LLM é—œéµå­—ç”Ÿæˆ
**ç›®æ¨™**: ä½¿ç”¨ LLM å‹•æ…‹ç”Ÿæˆæœ€å„ªæœå°‹é—œéµå­—

**åŠŸèƒ½æè¿°**:
- æ ¹æ“šè§¸ç™¼å™¨é¡å‹ç”Ÿæˆå°ˆç”¨é—œéµå­—
- è€ƒæ…® KOL äººè¨­å’Œå…§å®¹é¢¨æ ¼
- å‹•æ…‹èª¿æ•´é—œéµå­—ç­–ç•¥
- å„ªåŒ–æœå°‹çµæœç›¸é—œæ€§

**é—œéµå­—ç”Ÿæˆç­–ç•¥**:
```
ç†±é–€è©±é¡Œé—œéµå­—:
- è©±é¡Œåç¨± + ç›¸é—œç”¢æ¥­
- ç¤¾æœƒå½±éŸ¿ + æŠ•è³‡æ©Ÿæœƒ
- æ–°èç†±é» + å¸‚å ´åæ‡‰

ç›¤å¾Œæ¼²åœé—œéµå­—:
- è‚¡ç¥¨åç¨± + æ¼²åœåŸå› 
- æŠ€è¡“åˆ†æ + ç±Œç¢¼é¢
- ç”¢æ¥­å‹•æ…‹ + å…¬å¸æ¶ˆæ¯

ç›¤ä¸­æ¼²åœé—œéµå­—:
- å³æ™‚æ–°è + å¸‚å ´å‹•æ…‹
- äº¤æ˜“æ©Ÿæœƒ + é¢¨éšªæé†’
- çŸ­ç·šåˆ†æ + æ“ä½œå»ºè­°
```

##### 2.2 å¤šå±¤æ¬¡æœå°‹ç­–ç•¥
**ç›®æ¨™**: å¯¦ç¾å¤šå±¤æ¬¡çš„é—œéµå­—æœå°‹å’Œçµæœå„ªåŒ–

**åŠŸèƒ½æè¿°**:
- ä¸»è¦é—œéµå­—æœå°‹
- ç›¸é—œé—œéµå­—æ“´å±•
- çµæœç›¸é—œæ€§åˆ†æ
- é—œéµå­—å‹•æ…‹èª¿æ•´

**æœå°‹å±¤æ¬¡**:
```
ç¬¬ä¸€å±¤: ä¸»è¦é—œéµå­— (3-5å€‹)
ç¬¬äºŒå±¤: ç›¸é—œé—œéµå­— (5-8å€‹)  
ç¬¬ä¸‰å±¤: é•·å°¾é—œéµå­— (8-12å€‹)
ç¬¬å››å±¤: çµæœå„ªåŒ–èª¿æ•´
```

#### åŠŸèƒ½ 3: çµ±ä¸€ Serper API æ•´åˆ

##### 3.1 çµ±ä¸€æœå°‹å®¢æˆ¶ç«¯
**ç›®æ¨™**: å»ºç«‹çµ±ä¸€çš„ Serper API æœå°‹å®¢æˆ¶ç«¯

**åŠŸèƒ½æè¿°**:
- çµ±ä¸€çš„ API èª¿ç”¨ä»‹é¢
- éŒ¯èª¤è™•ç†å’Œé‡è©¦æ©Ÿåˆ¶
- çµæœå¿«å–å’Œå„ªåŒ–
- ä½¿ç”¨é‡ç›£æ§å’Œé™åˆ¶

##### 3.2 æ™ºèƒ½å…§å®¹å¢å¼·
**ç›®æ¨™**: ä½¿ç”¨æœå°‹çµæœæ™ºèƒ½å¢å¼·å…§å®¹å“è³ª

**åŠŸèƒ½æè¿°**:
- æ–°èå…§å®¹åˆ†æå’Œæ‘˜è¦
- ç›¸é—œè³‡è¨Šæå–å’Œæ•´åˆ
- å…§å®¹ç›¸é—œæ€§é©—è­‰
- å“è³ªè©•åˆ†å’Œå„ªåŒ–å»ºè­°

### ğŸ”§ æŠ€è¡“è¦æ ¼

#### æŠ€è¡“æ¶æ§‹
- **èªè¨€**: Python 3.9+
- **æ¡†æ¶**: FastAPI, OpenAI API
- **å¤–éƒ¨æœå‹™**: Serper API
- **æ•¸æ“šå­˜å„²**: PostgreSQL
- **å¿«å–**: Redis (å¯é¸)

#### API è¨­è¨ˆ
```python
# è§¸ç™¼å™¨å°ˆç”¨ Prompt ç³»çµ±
class TriggerSpecificPromptSystem:
    def get_prompt_strategy(self, trigger_type: TriggerType) -> PromptStrategy
    def generate_title_prompt(self, trigger_type: TriggerType, context: Dict) -> str
    def generate_content_prompt(self, trigger_type: TriggerType, context: Dict) -> str

# æ™ºèƒ½é—œéµå­—å„ªåŒ–ç³»çµ±  
class IntelligentKeywordOptimizer:
    def generate_keywords(self, trigger_type: TriggerType, context: Dict) -> List[str]
    def optimize_search_strategy(self, keywords: List[str]) -> SearchStrategy
    def analyze_relevance(self, results: List[Dict]) -> RelevanceScore

# çµ±ä¸€ Serper API æ•´åˆ
class UnifiedSerperIntegration:
    def search_news(self, keywords: List[str], strategy: SearchStrategy) -> List[Dict]
    def enhance_content(self, content: str, news_data: List[Dict]) -> EnhancedContent
```

#### æ•¸æ“šæ¨¡å‹
```python
@dataclass
class PromptStrategy:
    trigger_type: TriggerType
    system_prompt: str
    user_prompt_template: str
    keyword_generation_prompt: str
    content_enhancement_prompt: str

@dataclass
class SearchStrategy:
    primary_keywords: List[str]
    secondary_keywords: List[str]
    long_tail_keywords: List[str]
    search_params: Dict[str, Any]

@dataclass
class EnhancedContent:
    original_content: str
    enhanced_content: str
    news_sources: List[Dict]
    relevance_score: float
    enhancement_notes: List[str]
```

### ğŸ“Š å¯¦æ–½è¨ˆåŠƒ

#### éšæ®µ 1: è§¸ç™¼å™¨å°ˆç”¨ Prompt ç³»çµ± (2é€±)
- è¨­è¨ˆå„è§¸ç™¼å™¨çš„å°ˆç”¨ prompt æ¨¡æ¿
- å¯¦ç¾ PromptStrategy é¡åˆ¥
- æ•´åˆåˆ°ç¾æœ‰å…§å®¹ç”Ÿæˆæµç¨‹
- æ¸¬è©¦å’Œå„ªåŒ–

#### éšæ®µ 2: æ™ºèƒ½é—œéµå­—ç”Ÿæˆ (2é€±)  
- å¯¦ç¾ LLM é—œéµå­—ç”ŸæˆåŠŸèƒ½
- è¨­è¨ˆå¤šå±¤æ¬¡æœå°‹ç­–ç•¥
- å»ºç«‹é—œéµå­—å„ªåŒ–æ¼”ç®—æ³•
- æ•´åˆ Serper API

#### éšæ®µ 3: çµ±ä¸€æ•´åˆå’Œå„ªåŒ– (1é€±)
- çµ±ä¸€æ‰€æœ‰ Serper API èª¿ç”¨
- å¯¦ç¾æ™ºèƒ½å…§å®¹å¢å¼·
- æ€§èƒ½å„ªåŒ–å’Œç›£æ§
- å®Œæ•´æ¸¬è©¦å’Œéƒ¨ç½²

### ğŸ§ª æ¸¬è©¦ç­–ç•¥

#### å–®å…ƒæ¸¬è©¦
- å„è§¸ç™¼å™¨ prompt ç­–ç•¥æ¸¬è©¦
- é—œéµå­—ç”Ÿæˆæ¼”ç®—æ³•æ¸¬è©¦
- Serper API æ•´åˆæ¸¬è©¦

#### æ•´åˆæ¸¬è©¦
- ç«¯åˆ°ç«¯å…§å®¹ç”Ÿæˆæµç¨‹æ¸¬è©¦
- ä¸åŒè§¸ç™¼å™¨é¡å‹æ¯”è¼ƒæ¸¬è©¦
- æ€§èƒ½åŸºæº–æ¸¬è©¦

#### ç”¨æˆ¶é©—æ”¶æ¸¬è©¦
- KOL å…§å®¹å“è³ªè©•ä¼°
- æœå°‹çµæœç›¸é—œæ€§è©•ä¼°
- ç”¨æˆ¶é«”é©—æ¸¬è©¦

### ğŸ“ˆ æˆåŠŸæŒ‡æ¨™

#### æŠ€è¡“æŒ‡æ¨™
- å…§å®¹é‡è¤‡ç‡: < 20%
- æœå°‹çµæœç›¸é—œæ€§: > 80%
- API éŸ¿æ‡‰æ™‚é–“: < 2ç§’
- ç³»çµ±å¯ç”¨æ€§: > 99%

#### æ¥­å‹™æŒ‡æ¨™
- KOL å…§å®¹å“è³ªè©•åˆ†æå‡
- ç”¨æˆ¶äº’å‹•ç‡æå‡
- å…§å®¹åˆ†äº«ç‡æå‡
- ç³»çµ±ç¶­è­·æˆæœ¬é™ä½

### ğŸ”’ é¢¨éšªè©•ä¼°

#### æŠ€è¡“é¢¨éšª
- **API é™åˆ¶**: Serper API ä½¿ç”¨é‡é™åˆ¶
- **LLM æˆæœ¬**: OpenAI API èª¿ç”¨æˆæœ¬
- **æ€§èƒ½å½±éŸ¿**: é¡å¤–çš„ API èª¿ç”¨å¯èƒ½å½±éŸ¿éŸ¿æ‡‰æ™‚é–“

#### ç·©è§£æªæ–½
- å¯¦ç¾ API ä½¿ç”¨é‡ç›£æ§å’Œé™åˆ¶
- å„ªåŒ– LLM èª¿ç”¨ç­–ç•¥ï¼Œæ¸›å°‘ä¸å¿…è¦çš„èª¿ç”¨
- å¯¦ç¾çµæœå¿«å–å’Œç•°æ­¥è™•ç†

### ğŸ“š ç›¸é—œæ–‡æª”

- [å‹•æ…‹ Prompting ç³»çµ±è¨­è¨ˆ](./dynamic-prompting-system.md)
- [Serper API æ•´åˆæŒ‡å—](./serper-api-integration.md)
- [è§¸ç™¼å™¨ç³»çµ±æ¶æ§‹](./trigger-system-architecture.md)
- [å…§å®¹ç”Ÿæˆæµç¨‹](./content-generation-flow.md)

---

**æ–‡æª”ç‰ˆæœ¬**: v1.0  
**æœ€å¾Œæ›´æ–°**: 2025-01-15  
**å¯©æ ¸ç‹€æ…‹**: å¾…å¯©æ ¸
