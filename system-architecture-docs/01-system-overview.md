# 系統總覽

## 🎯 系統目標

虛擬 KOL 系統是一個自動化的內容生成和發布平台，主要功能包括：

1. **自動化內容生成** - 基於股票數據和市場事件生成投資分析內容
2. **KOL 角色管理** - 管理多個虛擬 KOL 角色，每個角色有獨特的風格和受眾
3. **智能觸發系統** - 監控市場數據，自動觸發內容生成
4. **自我學習優化** - 分析互動數據，優化內容生成參數
5. **排程發布管理** - 自動化內容發布到 CMoney 平台

## 🏗️ 整體架構

```
┌─────────────────────────────────────────────────────────────────┐
│                        前端層 (Frontend)                        │
├─────────────────────────────────────────────────────────────────┤
│  React + TypeScript + Ant Design + Vite                        │
│  - 儀表板總覽     - 系統監控     - 內容管理                    │
│  - 發文管理       - 互動分析     - 系統設置                    │
│  - 用戶管理       - KOL 管理     - 排程管理                    │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                        API 層 (Backend)                         │
├─────────────────────────────────────────────────────────────────┤
│  FastAPI + Python + PostgreSQL                                 │
│  - posting-service (8001)  - dashboard-backend (8012)          │
│  - 貼文管理 API            - 儀表板 API                        │
│  - KOL 管理 API            - 用戶管理 API                      │
│  - 互動分析 API            - 排程管理 API                      │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                       數據層 (Database)                         │
├─────────────────────────────────────────────────────────────────┤
│  PostgreSQL (5432)                                             │
│  - post_records (貼文記錄)    - kol_profiles (KOL 設定)        │
│  - schedules (排程管理)       - user_management (用戶管理)      │
│  - interaction_data (互動數據) - system_logs (系統日誌)        │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                      外部服務層 (External)                      │
├─────────────────────────────────────────────────────────────────┤
│  - OpenAI GPT API (內容生成)   - CMoney API (發布平台)          │
│  - Serper API (新聞搜尋)      - FinLab API (金融數據)          │
│  - OHLC API (股價數據)        - Trending API (熱門話題)        │
└─────────────────────────────────────────────────────────────────┘
```

## 🔧 核心模組

### 1. 虛擬 KOL 系統
- **KOL 角色管理**: 管理多個虛擬 KOL，每個角色有獨特的人格設定
- **內容風格**: 技術分析、基本面分析、籌碼面分析等不同風格
- **目標受眾**: 活躍交易者、長期投資者、新手投資者等
- **互動模式**: 隨機分配、固定分配、動態分配

### 2. 觸發器系統
- **盤後觸發器**: 盤後漲停、盤後跌停
- **成交量觸發器**: 成交金額高/低、成交金額變化率高/低
- **自定義觸發器**: 手動輸入股票代號
- **智能新聞搜尋**: 根據觸發器類型自動搜尋相關新聞

### 3. 內容生成系統
- **AI 內容生成**: 使用 OpenAI GPT 生成投資分析內容
- **數據源整合**: 整合股價數據、新聞資訊、技術指標
- **內容審核**: 自動/人工審核生成內容
- **批次處理**: 支援批量生成多篇內容

### 4. 排程管理系統
- **自動排程**: 基於觸發器自動創建發布排程
- **手動排程**: 手動設定發布時間和內容
- **排程優化**: 基於互動數據優化發布時間
- **執行監控**: 監控排程執行狀態和結果

### 5. 自我學習系統
- **互動數據分析**: 分析貼文的按讚、留言、分享數據
- **前20%內容特徵**: 識別高互動內容的共同特徵
- **參數優化**: 自動調整內容生成參數
- **排程優化**: 優化發布時間和頻率

### 6. 互動分析系統
- **數據收集**: 從 CMoney 平台收集互動數據
- **統計分析**: 分析互動趨勢和模式
- **視覺化展示**: 提供互動數據的視覺化圖表
- **成效評估**: 評估內容策略的效果

## 📊 數據流程

### 主要業務流程

1. **觸發器檢測流程**
   ```
   市場數據 → 觸發器檢測 → 股票篩選 → 新聞搜尋 → 觸發內容生成
   ```

2. **內容生成流程**
   ```
   觸發器 → KOL 分配 → 數據收集 → AI 生成 → 內容審核 → 排程發布
   ```

3. **發布管理流程**
   ```
   排程觸發 → 內容發布 → CMoney 平台 → 互動追蹤 → 數據分析
   ```

4. **自我學習流程**
   ```
   互動數據 → 特徵分析 → 參數優化 → 策略調整 → 效果驗證
   ```

## 🎨 用戶界面

### 儀表板總覽
- 系統狀態概覽
- 關鍵指標展示
- 快速操作入口
- 最近活動記錄

### 發文管理
- 發文生成器
- 發文審核
- 已發布貼文
- 批次歷史
- 排程管理

### 互動分析
- 互動總覽
- 內容特徵分析
- 時間段分析 (1小時/1日/7日)
- 成效分析

### 系統設置
- 基本設置
- API 設置
- 數據源設置
- 用戶管理

## 🔒 安全架構

### 認證與授權
- JWT Token 認證
- 角色權限控制
- API 訪問限制
- 數據加密傳輸

### 數據安全
- 敏感數據加密
- API 金鑰環境變數管理
- 數據庫連接加密
- 日誌安全處理

### 系統安全
- CORS 跨域保護
- 請求頻率限制
- 錯誤處理機制
- 系統監控告警

## 📈 性能指標

### 響應時間
- 頁面載入: < 2秒
- API 響應: < 1秒
- 內容生成: < 30秒
- 數據查詢: < 500ms

### 並發處理
- 同時用戶: 100+
- API 請求: 1000/秒
- 內容生成: 10/分鐘
- 數據處理: 10000/小時

### 可用性
- 系統可用性: > 99.9%
- 數據準確性: > 95%
- 內容品質: > 90%
- 用戶滿意度: > 85%

## 🚀 部署架構

### 開發環境
- 本地開發: Docker Compose
- 前端開發: Vite 熱重載
- 後端開發: FastAPI 自動重載
- 數據庫: PostgreSQL 本地實例

### 生產環境
- 容器化部署: Docker + Kubernetes
- 負載均衡: Nginx
- 數據庫: PostgreSQL 集群
- 監控: Prometheus + Grafana

### 擴展性
- 水平擴展: 微服務架構
- 垂直擴展: 資源動態調整
- 數據分片: 按時間分片
- 緩存策略: Redis 緩存


