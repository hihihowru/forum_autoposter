#!/usr/bin/env python3
"""
恢復之前的貼文數據
"""

from src.clients.google.sheets_client import GoogleSheetsClient

def restore_previous_posts():
    """恢復之前的貼文數據"""
    sheets_client = GoogleSheetsClient(
        "./credentials/google-service-account.json",
        "148CUhBxqE-BZDPTKaAmOJG6m52CxB4KrxD9p5LikN2s"
    )
    
    # 之前的貼文數據（從您提供的資料）
    previous_posts = [
        # 第2行 - 台股高檔震盪貼文
        [
            "19cab017-cdcf-41ec-b07b-c43fdc427c80-203", "203", "龜狗一日散戶", "台股", "TWA00", "enhanced_trending_topics",
            "173477844", "https://www.cmoney.tw/forum/article/173477844",
            "台股高檔震盪，開高走平背後的真相？",
            "你們敢嗎？今天的台股再次讓人捏一把冷汗，開盤雖然高開，但卻一路走平，這背後到底隱藏了什麼樣的市場信號？我們來看看數據。首先，台積電的表現依然穩定，報價1165元，變化不大，技術指標評分為5.0/10，信心度僅26.4%。這意味著市場對於台積電的未來方向仍舊模糊。RSI指標在中軸附近徘徊，顯示出投資者情緒的謹慎；而均線關係也沒有明顯變化，這都反映出當前動能不足。再來看看0050指數，報價52元，同樣沒有變化，技術指標評分為4.1/10，信心度稍高於台積電，但依然不明確。MACD快慢線糾纏不清，短期內缺乏明確的上漲或下跌信號。成交量的低迷更是讓市場缺乏參與感，這使得投資者在操作上必須更加謹慎。綜合來看，今天的台股高檔震盪，其實是多重技術指標發出的警告：市場情緒不高，加上成交量萎縮，風險控制顯得尤為重要。因此，我們的操作建議是觀望。等到市場出現更明確的方向再做決定，你們敢嗎？",
            '[{"type": "Stock", "key": "TWA00", "bullOrBear": 0}, {"type": "Stock", "key": "2330", "bullOrBear": 0}, {"type": "Stock", "key": "0050", "bullOrBear": 0}]',
            "published"
        ],
        # 第3行 - 台股高檔震盪貼文2
        [
            "19cab017-cdcf-41ec-b07b-c43fdc427c80-204", "204", "板橋大who", "台股", "TWA00", "enhanced_trending_topics",
            "173477845", "https://www.cmoney.tw/forum/article/173477845",
            "高檔震盪的背後，市場心態何在？",
            "來說個故事，今天台股開盤雖然高漲，但隨後卻平靜如水。0050和鴻海的表現都讓人摸不著頭腦，0050報價$52.00，技術評分僅4.1/10，信心度低至33%，顯示市場情緒不明。MACD指標糾纏不清，反映出短期方向的迷茫。而鴻海雖然稍微強勁些，報價$198.50，但技術評分也只有4.8/10，信心度24.7%。成交量低迷，讓整個市場缺乏活力。面對這樣的狀況，我們或許應該暫時觀望。你覺得接下來會怎麼發展？市場會再找回動能，還是會繼續震盪不前呢？",
            '[{"type": "Stock", "key": "TWA00", "bullOrBear": 0}, {"type": "Stock", "key": "0050", "bullOrBear": 0}, {"type": "Stock", "key": "2317", "bullOrBear": 0}]',
            "published"
        ],
        # 第4行 - 康霈生技貼文1
        [
            "6919_200_20250902_184535", "200", "川川哥", "康霈生技", "6919", "6919_kangpei_20250902",
            "173481664", "https://www.cmoney.tw/forum/article/173481664",
            "康霈生技(6919)漲停！CBL-514神秘力量嘎到！",
            "康霈生技(6919)今日嘎到漲停！技術面爆量，K棒跳空缺口，MACD背離支撐帶！專業分析指標顯示黃金交叉即將爆發！CBL-514減重新藥題材熱度持續升溫，市場熱議，外資買盤動向強勁！但切記追高需謹慎，盤勢或因消息面變化而起起伏伏！穩了啦，要噴啦，睡醒漲停！風險自負，勿貪！想知道的話，留言告訴我，咱們一起討論一下...",
            '[{"type": "Stock", "key": "6919", "bullOrBear": 0}]',
            "published"
        ],
        # 第5行 - 康霈生技貼文2
        [
            "6919_201_20250902_184540", "201", "韭割哥", "康霈生技", "6919", "6919_kangpei_20250902",
            "173481665", "https://www.cmoney.tw/forum/article/173481665",
            "康霈生技(6919)：減重新藥CBL-514引領漲停風潮 📈",
            "近期市場熱議康霈生技(6919)，其股價出現漲停表現，背後的原因何在？讓我們從技術面和基本面進行深入分析。技術面上，康霈生技的減重新藥CBL-514題材一拍即合，引領著漲停風潮。這項新藥的研發進展值得關注，將直接影響公司未來的市場表現。此一利好消息穩定了投資者情緒，成為股價上漲的催化劑。另一方面，外資買盤的動向也值得關注。外資的持續看好往往能帶動股價持續上揚，對康霈生技的長期投資價值有所支撐。綜合分析，建議投資者在關注減重新藥CBL-514的同時，也應注意公司的財務結構、產業競爭力等基本面因素，以全面評估投資價值。然而，投資須謹慎，研發風險、法規風險、競爭風險不可忽視。康霈生技的漲停題材吸引眾多投資者目光，但投資要有耐心，時間將證明一切的價值。📊 💡 💰",
            '[{"type": "Stock", "key": "6919", "bullOrBear": 0}]',
            "published"
        ]
    ]
    
    try:
        # 在現有數據前面插入之前的貼文
        for i, post in enumerate(previous_posts):
            row_num = i + 2  # 從第2行開始插入
            range_name = f"A{row_num}:L{row_num}"
            sheets_client.write_sheet('貼文記錄表', [post], range_name=range_name)
            print(f"✅ 恢復第{row_num}行: {post[0]}")
        
        print("✅ 已恢復之前的貼文數據")
        
    except Exception as e:
        print(f"❌ 恢復貼文數據失敗: {e}")

if __name__ == "__main__":
    restore_previous_posts()
